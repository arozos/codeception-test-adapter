# Codeception Testing Extension for Visual Studio Code

This extension provides comprehensive support for the PHP Codeception testing framework within Visual Studio Code's native testing environment. It seamlessly integrates Codeception tests into VSCode's Test Explorer, allowing you to discover, run, debug, and manage your tests directly from the IDE with full support for local and Docker-based test execution.

**Disclaimer:** This was developed for internal use, so it has been tested only in specific environments (WSL). This will be updated only for critical bugs, except for the features referenced in the Roadmap. That said, feel free to discuss a feature and make a contribution.

## Features

- ğŸ§ª **Native Test Explorer Integration** - Tests appear in VSCode's Testing sidebar with the test beaker icon
- ğŸ” **Automatic Test Discovery** - Automatically finds all Test, Cest, and Cept files in your project
- â–¶ï¸ **Run Individual Tests** - Click the play button next to any test method, file, or suite
- ğŸ“Š **Suite Organization** - Tests organized by Codeception suites (unit, functional, acceptance)
- ğŸ”„ **Auto-refresh** - Tests automatically update when you save files
- ğŸ¯ **Run at Any Level** - Execute entire suites, individual files, or specific test methods
- ğŸ³ **Docker Support** - Run tests inside Docker containers with automatic working directory detection
- ğŸ“ˆ **Code Coverage** - Built-in support for test coverage visualization and reporting
- ğŸ’» **CodeLens Integration** - Run and debug tests directly from your code editor
- âš™ï¸ **Flexible Configuration** - Customize test execution with configurable paths, arguments, and suites

## Useful Commands

- **Codeception Test Explorer: Run From Docker...** - Select a running Docker container to execute tests inside
- **Refresh Tests** - Manually refresh test discovery (tests auto-refresh on file save)
- **Run Test** - Execute a specific test, file, or suite from the Test Explorer or CodeLens
- **Debug Test** - Debug a specific test with breakpoint support (Xdebug integration) -- Coming Soon
- **Run with Coverage** - Execute tests with code coverage analysis enabled

## Requirements

- VSCode 1.75.0 or higher
- Codeception installed via Composer
- PHP 7.4 or higher

## Installation

### From Source (Development)

1. Clone this repository
2. Run `npm install`
3. Run `npm run compile`
4. Press F5 to open a new VSCode window with the extension loaded

### Future: From Marketplace

Will be published to VSCode Marketplace once stable.

## Usage

1. Open a project with Codeception tests
2. Click the Testing icon in the sidebar (ğŸ§ª beaker icon)
3. Your tests will automatically appear organized by suite
4. Click the â–¶ï¸ play button next to any test/file/suite to run it
5. See results inline with green âœ“ or red âœ—

## Configuration

Configure in VSCode settings (File > Preferences > Settings):

```json
{
  "codeceptionphp.binary.path": "vendor/bin/codecept",
  "codeceptionphp.binary.args": "--steps",
  "codeceptionphp.configFile": "codeception.yml",
  "codeceptionphp.suites": ["unit", "functional", "acceptance"]
}
```

### Settings

- `codeceptionphp.binary.path` - Path to codecept binary (default: `vendor/bin/codecept`)
- `codeceptionphp.binary.args` - Additional arguments/flags to pass to codecept binary (default: `--steps`)
- `codeceptionphp.configFile` - Path to codeception config (default: `codeception.yml`)
- `codeceptionphp.suites` - Array of suites to discover (default: `["unit", "functional", "acceptance"]`)
- `codeceptionphp.docker.enabled` - Run tests inside a Docker container (default: `false`)
- `codeceptionphp.docker.container` - Docker container name or ID to run tests in
- `codeceptionphp.docker.workdir` - Working directory inside the Docker container
- `codeceptionphp.coverage.alwaysRun` - Always run tests with coverage enabled (default: `false`)

## Coverage Visualization

This extension works seamlessly with [Coverage Gutters](https://marketplace.visualstudio.com/items?itemName=ryanluker.vscode-coverage-gutters) for enhanced coverage visualization in your code editor. Coverage Gutters displays test coverage generated by lcov or xml files directly in the gutter of your editor.

### Setup

1. Install the [Coverage Gutters extension](https://marketplace.visualstudio.com/items?itemName=ryanluker.vscode-coverage-gutters)
2. Configure Codeception to generate coverage reports (XML or Clover format)
3. Configure Coverage Gutters to point to your coverage files

### Example Configuration

```json
{
  "coverage-gutters.coverageFileNames": [
    "tests/_output/coverage.xml",
    "tests/_output/clover.xml"
  ],
  "coverage-gutters.remotePathResolve": [
    "/var/www/html",
    "."
  ]
}
```

**Note:** 
- Set `coverageFileNames` to match the path where Codeception generates your coverage files
- Only use `remotePathResolve` if you're running tests in Docker - it maps the container path (e.g., `/var/www/html`) to your local workspace (`.`)

### How It Works

- Run your tests with coverage enabled using this extension
- Coverage Gutters will automatically detect the coverage files
- Coverage indicators will appear in the gutter showing which lines are covered

This combination provides a complete testing and coverage workflow for Codeception projects.

## Project Structure

The extension expects the standard Codeception structure:

```
project/
â”œâ”€â”€ codeception.yml
â”œâ”€â”€ vendor/
â”‚   â””â”€â”€ bin/
â”‚       â””â”€â”€ codecept
â””â”€â”€ tests/
    â”œâ”€â”€ unit/
    â”‚   â””â”€â”€ ExampleTest.php
    â”œâ”€â”€ functional/
    â”‚   â””â”€â”€ ExampleCest.php
    â””â”€â”€ acceptance/
        â””â”€â”€ ExampleCept.php
```

## Running Tests

### From Test Explorer

- Click â–¶ï¸ next to a suite to run all tests in that suite
- Click â–¶ï¸ next to a file to run all tests in that file
- Click â–¶ï¸ next to a test method to run just that test

### From Code

- Hover over a test method
- Click "Run Test" or "Debug Test" in the CodeLens

## Roadmap

- [ ] Debug support with Xdebug integration
- [ ] Better error parsing and display
- [ ] Custom test arguments configuration


### Contributing

Contributions welcome! Please:

1. Fork the repository
2. Create a feature branch
3. Make your changes
4. Submit a pull request

## Known Issues

- Debug(XDEBUG) support not yet implemented
- Large test suites may take time to discover
- Error messages could be more detailed

## License

MIT

## Credits

Inspired by existing Codeception extensions but built for the native VSCode Testing API.
